{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const navigate=useNavigate();useEffect(()=>{// 로컬 스토리지에서 사용자 정보 확인\nconst storedUser=localStorage.getItem('user');if(storedUser){setUser(JSON.parse(storedUser));}},[]);const login=async(email,password)=>{try{// API 호출 로직 구현 필요\nconst response=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password})});if(!response.ok){throw new Error('로그인 실패');}const userData=await response.json();setUser(userData);localStorage.setItem('user',JSON.stringify(userData));navigate('/');}catch(error){console.error('로그인 에러:',error);throw error;}};const logout=()=>{setUser(null);localStorage.removeItem('user');navigate('/login');};const loginWithOAuth=provider=>{const providers={google:'https://accounts.google.com/o/oauth2/v2/auth',naver:'https://nid.naver.com/oauth2.0/authorize',kakao:'https://kauth.kakao.com/oauth/authorize',meta:'https://www.facebook.com/v12.0/dialog/oauth'};const clientIds={google:process.env.REACT_APP_GOOGLE_CLIENT_ID,naver:process.env.REACT_APP_NAVER_CLIENT_ID,kakao:process.env.REACT_APP_KAKAO_CLIENT_ID,meta:process.env.REACT_APP_META_CLIENT_ID};const redirectUri=\"\".concat(window.location.origin,\"/oauth/callback/\").concat(provider);const scope='email profile';const url=new URL(providers[provider]);url.searchParams.append('client_id',clientIds[provider]||'');url.searchParams.append('redirect_uri',redirectUri);url.searchParams.append('response_type','code');url.searchParams.append('scope',scope);window.location.href=url.toString();};const handleOAuthCallback=async(provider,code)=>{try{const response=await fetch(\"/api/oauth/\".concat(provider,\"/callback\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({code})});if(!response.ok){throw new Error('OAuth 로그인 실패');}const userData=await response.json();setUser(userData);localStorage.setItem('user',JSON.stringify(userData));navigate('/');}catch(error){console.error('OAuth 로그인 에러:',error);throw error;}};const value={user,login,loginWithOAuth,handleOAuthCallback,logout,isAuthenticated:!!user};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useNavigate","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","user","setUser","navigate","storedUser","localStorage","getItem","JSON","parse","login","email","password","response","fetch","method","headers","body","stringify","ok","Error","userData","json","setItem","error","console","logout","removeItem","loginWithOAuth","provider","providers","google","naver","kakao","meta","clientIds","process","env","REACT_APP_GOOGLE_CLIENT_ID","REACT_APP_NAVER_CLIENT_ID","REACT_APP_KAKAO_CLIENT_ID","REACT_APP_META_CLIENT_ID","redirectUri","concat","window","location","origin","scope","url","URL","searchParams","append","href","toString","handleOAuthCallback","code","value","isAuthenticated","Provider","useAuth","context"],"sources":["/Users/daeyeop/Desktop/I-eung/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\ninterface User {\n  id: number;\n  name: string;\n  email: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  login: (email: string, password: string) => Promise<void>;\n  loginWithOAuth: (provider: string) => void;\n  handleOAuthCallback: (provider: string, code: string) => Promise<void>;\n  logout: () => void;\n  isAuthenticated: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // 로컬 스토리지에서 사용자 정보 확인\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      setUser(JSON.parse(storedUser));\n    }\n  }, []);\n\n  const login = async (email: string, password: string) => {\n    try {\n      // API 호출 로직 구현 필요\n      const response = await fetch('/api/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email, password }),\n      });\n\n      if (!response.ok) {\n        throw new Error('로그인 실패');\n      }\n\n      const userData = await response.json();\n      setUser(userData);\n      localStorage.setItem('user', JSON.stringify(userData));\n      navigate('/');\n    } catch (error) {\n      console.error('로그인 에러:', error);\n      throw error;\n    }\n  };\n\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n\n  const loginWithOAuth = (provider: string) => {\n    const providers = {\n      google: 'https://accounts.google.com/o/oauth2/v2/auth',\n      naver: 'https://nid.naver.com/oauth2.0/authorize',\n      kakao: 'https://kauth.kakao.com/oauth/authorize',\n      meta: 'https://www.facebook.com/v12.0/dialog/oauth'\n    };\n\n    const clientIds = {\n      google: process.env.REACT_APP_GOOGLE_CLIENT_ID,\n      naver: process.env.REACT_APP_NAVER_CLIENT_ID,\n      kakao: process.env.REACT_APP_KAKAO_CLIENT_ID,\n      meta: process.env.REACT_APP_META_CLIENT_ID\n    };\n\n    const redirectUri = `${window.location.origin}/oauth/callback/${provider}`;\n    const scope = 'email profile';\n\n    const url = new URL(providers[provider as keyof typeof providers]);\n    url.searchParams.append('client_id', clientIds[provider as keyof typeof clientIds] || '');\n    url.searchParams.append('redirect_uri', redirectUri);\n    url.searchParams.append('response_type', 'code');\n    url.searchParams.append('scope', scope);\n\n    window.location.href = url.toString();\n  };\n\n  const handleOAuthCallback = async (provider: string, code: string) => {\n    try {\n      const response = await fetch(`/api/oauth/${provider}/callback`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ code }),\n      });\n\n      if (!response.ok) {\n        throw new Error('OAuth 로그인 실패');\n      }\n\n      const userData = await response.json();\n      setUser(userData);\n      localStorage.setItem('user', JSON.stringify(userData));\n      navigate('/');\n    } catch (error) {\n      console.error('OAuth 로그인 에러:', error);\n      throw error;\n    }\n  };\n\n  const value = {\n    user,\n    login,\n    loginWithOAuth,\n    handleOAuthCallback,\n    logout,\n    isAuthenticated: !!user,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}